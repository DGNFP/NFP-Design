{{ define "main" }}
<!-- 메인페이지 전용 CSS -->
<link rel="stylesheet" href="{{ "css/popup.css" | relURL }}">

<!-- 히어로 섹션 -->
<section class="hero" id="home">
    <div class="container">
        <div class="hero-content">
            <h1 class="hero-title">안녕하세요.<br><span>NFP 디자인 </span>입니다.</h1>
            <p class="hero-subtitle"><br>고객의 <span>Needs</span>를 읽는 섬세한 시선<br>트렌드를 이끄는 <span>Fresh</span>한 감각<br>디테일을 살린 <span>Pop</span>한 디자인<br><span>NFP</span> 디자인, 디테일에서 시작해 트렌드를 완성하다.</p>
            <div class="hero-btns">
                <a href="{{ "posts" | relURL }}" class="btn">작업 보기</a>
                <a href="#contact" class="btn btn-outline">연락하기</a>
            </div>
        </div>
    </div>
</section>

<!-- 프로젝트 섹션 -->
<section id="design">
    <div class="container">
        <h2 class="section-title">프로젝트</h2>
        
        <!-- 기존 카테고리 그리드 -->
        <div class="design-grid">
            <div class="design-item">
                <a href="{{ "/categories/web/" | relURL }}">
                    <img src="{{ "img/category/web.png" | relURL }}" alt="웹 디자인" class="design-img">
                    <div class="design-overlay">
                        <h3 class="design-title">웹 디자인</h3>
                        <p class="design-sub">홈페이지, 랜딩페이지, 광고 배너 등<br>웹 기반 디자인</p>
                        <a href="{{ "/categories/web/" | relURL }}" class="view-work">상세보기</a>
                    </div>
                </a>
            </div>

            <div class="design-item">
                <a href="{{ "/categories/content/" | relURL }}">
                    <img src="{{ "img/category/content.png" | relURL }}" alt="컨텐츠 디자인" class="design-img">
                    <div class="design-overlay">
                        <h3 class="design-title">컨텐츠 디자인</h3>
                        <p class="design-sub">카드뉴스, 상세페이지, 포스터 등<br>다양한 컨텐츠 디자인</p>
                        <a href="{{ "/categories/content/" | relURL }}" class="view-work">상세보기</a>
                    </div>
                </a>
            </div>

            <div class="design-item">
                <a href="{{ "/categories/creative/" | relURL }}">
                    <img src="{{ "img/category/creative.png" | relURL }}" alt="크리에이티브 디자인" class="design-img">
                    <div class="design-overlay">
                        <h3 class="design-title">크리에이티브 디자인</h3>
                        <p class="design-sub">게임광고, 로고, 인터넷 방송 등<br>다양한 디지털 컨텐츠</p>
                        <a href="{{ "/categories/creative/" | relURL }}" class="view-work">상세보기</a>
                    </div>
                </a>
            </div>

            <div class="design-item">
                <a href="{{ "/categories/video/" | relURL }}">
                    <img src="{{ "img/category/video.png" | relURL }}" alt="영상 디자인" class="design-img">
                    <div class="design-overlay">
                        <h3 class="design-title">영상 디자인</h3>
                        <p class="design-sub">영상 제작, 영상 편집, 모션 그래픽 등<br>영상 관련 작업</p>
                        <a href="{{ "/categories/video/" | relURL }}" class="view-work">상세보기</a>
                    </div>
                </a>
            </div>

            <div class="design-item">
                <a href="{{ "/categories/programming/" | relURL }}">
                    <img src="{{ "img/category/programming.png" | relURL }}" alt="프로그래밍" class="design-img">
                    <div class="design-overlay">
                        <h3 class="design-title">프로그래밍</h3>
                        <p class="design-sub">프론트엔드, 웹 퍼블리싱, 게임개발 등<br>프로그래밍 관련 작업</p>
                        <a href="{{ "/categories/programming/" | relURL }}" class="view-work">상세보기</a>
                    </div>
                </a>
            </div>

            <div class="design-item">
                <a href="{{ "/categories/ad/" | relURL }}">
                    <img src="{{ "img/category/ad.png" | relURL }}" alt="광고,인쇄 디자인" class="design-img">
                    <div class="design-overlay">
                        <h3 class="design-title">광고/인쇄 디자인</h3>
                        <p class="design-sub">현수막, 명함, 브로슈어 등<br>오프라인 광고 매체 디자인</p>
                        <a href="{{ "/categories/ad/" | relURL }}" class="view-work">상세보기</a>
                    </div>
                </a>
            </div>
        </div>
    </div>
</section>

<!-- 하이라이트 섹션 (랜덤 게시글) -->
<section class="portfolio-highlights">
    <div class="container">
        <h3 class="project-section-title">하이라이트</h3>
    </div>
    <!-- 슬라이더 컨테이너 - 1200px 제한 + 패딩 -->
    <div class="highlight-slider-container">
        <div class="center" id="highlight-container">
            <!-- JavaScript로 동적 생성될 영역 -->
        </div>
    </div>
</section>


<!-- 메인 프로젝트 섹션 (Autoplay) - 전체 너비 -->
<section class="main-projects-section">
    <div class="container">
        <h3 class="project-section-title">메인 프로젝트</h3>
    </div>
    
    <div class="autoplay" id="main-projects-container">
        <!-- JavaScript로 동적 생성될 영역 -->
         
    </div>
    <a href="{{ "/categories/project/" | relURL }}" class="main-project-more-btn">프로젝트 더보기</a>
</section>



<!-- 소개 섹션 -->
<section id="about" class="about">
    <div class="container">
        <h2 class="section-title">소개</h2>
        <div class="about-content">
            <div class="about-info">
                <h3>열정적인 디자이너의 이야기</h3>
                <p>10년 이상의 디자인 경력을 바탕으로 다양한 브랜드와 협업하며 창의적인 비전을 실현해왔습니다. 디자인은 단순한 직업이 아닌 저의 열정이자 삶의 방식입니다.</p>
                <p>미니멀리즘과 기능성을 중시하면서도 독창적인 요소를 통해 차별화된 디자인을 추구합니다. 클라이언트의 요구사항을 깊이 이해하고 공감하여 문제를 해결하는 디자인을 제공합니다.</p>
                <div class="skills">
                    <span class="skill-main">#웹 디자인</span>
                    <span class="skill">홈페이지 디자인</span>
                    <span class="skill">디지털 배너 디자인</span>
                    <span class="skill">상세페이지 디자인</span>
                    <span class="skill">UX/UI 디자인</span>
                    <span class="skill-main">#컨텐츠 디자인</span>
                    <span class="skill">카드뉴스 디자인</span>
                    <span class="skill">포스터 디자인</span>
                    <span class="skill">이벤트 페이지 디자인</span>
                    <span class="skill">SNS광고 디자인</span>
                    <span class="skill-main">#크리에이티브 디자인</span>
                    <span class="skill">로고 디자인</span>
                    <span class="skill">브랜딩</span>
                    <span class="skill">게임 광고 디자인</span>
                    <span class="skill">인터넷 방송 디자인</span>
                    <span class="skill-main">#영상 디자인</span>
                    <span class="skill">영상 제작</span>
                    <span class="skill">영상 편집</span>
                    <span class="skill">모션 그래픽</span>
                    <span class="skill">유튜브 썸네일</span>
                    <span class="skill-main">#프로그래밍</span>
                    <span class="skill">프론트엔드</span>
                    <span class="skill">웹 퍼블리싱</span>
                    <span class="skill">모바일 앱</span>
                    <span class="skill">게임 개발</span>
                    <span class="skill-main">#광고/인쇄 디자인</span>
                    <span class="skill">현수막/엑스배너 디자인</span>
                    <span class="skill">명함 디자인</span>
                    <span class="skill">브로슈어/카탈로그 디자인</span>
                    <span class="skill">홍보물 디자인</span>
                    <span class="skill">패키지 디자인</span>
                </div>
                <!-- 버튼 영역 수정 -->
                <div class="about-buttons">
                    <a href="#contact" class="btn">함께 일해요</a>
                    <a class="btn btn-outline" id="portfolio-detail-btn">상세보기</a>

                   

                </div>
            </div>
            <img src="{{ "img/NFP.png" | relURL }}" alt="프로필 이미지" class="about-img">
        </div>
    </div>
</section>

<!-- 소식 섹션 -->
<section id="news" class="news">
    <div class="container">
        <div class="news-header">
            <h2 class="section-title">소식</h2>
            <a href="/news/" class="btn btn-more">더보기</a>
        </div>
        <div class="news-content">
           <div class="banner-container">
                <div class="banner-slider">
                    <!-- 고정 배너 이미지 5개 -->
                    <div class="banner">  <!-- active 클래스 제거! -->
                        <img src="img/banner/banner1.png" class="pc_img" alt="소식 배너 1">
                    </div>
                    <div class="banner">
                        <img src="img/banner/banner2.png" class="pc_img" alt="소식 배너 2">
                    </div>
                    <div class="banner">
                        <img src="img/banner/banner1.png" class="pc_img" alt="소식 배너 3">
                    </div>
                    <div class="banner">
                        <img src="img/banner/banner2.png" class="pc_img" alt="소식 배너 4">
                    </div>
                    <div class="banner">
                        <img src="img/banner/banner1.png" class="pc_img" alt="소식 배너 5">
                    </div>
                </div>
                
                <!-- 고정 도트 5개 -->
                <div class="banner-dots">
                    <span class="banner-dot"></span>
                    <span class="banner-dot"></span>
                    <span class="banner-dot"></span>
                    <span class="banner-dot"></span>
                    <span class="banner-dot"></span>
                </div>
            </div>

            <button class="banner-btn prev-btn"><i class="fas fa-chevron-left"></i></button>
                <button class="banner-btn next-btn"><i class="fas fa-chevron-right"></i></button>

               <div class="news-list">
    <!-- 공지사항 최신 1개 (맨 위에 표시) -->
    {{ $noticePosts := where site.RegularPages "Section" "notice" }}
    {{ range first 1 $noticePosts.ByDate.Reverse }}
    <div class="news-item">
        <a href="{{ .Permalink }}" class="news-link">
            <span class="news-title">
                <span class="notice-badge">[공지]</span> {{ .Title }}
            </span>
            <span class="news-date">{{ .Date.Format "2006.01.02" }}</span>
        </a>
    </div>
    {{ end }}
    
    <!-- 일반 소식 최신 4개 -->
    {{ $newsPosts := where site.RegularPages "Section" "news" }}
    {{ range first 4 $newsPosts.ByDate.Reverse }}
    <div class="news-item">
        <a href="{{ .Permalink }}" class="news-link">
            <span class="news-title">{{ .Title }}</span>
            <span class="news-date">{{ .Date.Format "2006.01.02" }}</span>
        </a>
    </div>
    {{ end }}
    
    <!-- 게시글이 전혀 없을 때 -->
    {{ if and (not $noticePosts) (not $newsPosts) }}
    <div class="news-item">
        <div class="news-link">
            <span class="news-title">소식이 없습니다</span>
            <span class="news-date">2025.05.24</span>
        </div>
    </div>
    {{ end }}
</div>

    </div>
</section>

<!-- 연락처 섹션 -->
<section id="contact" class="contact">
    <div class="container">
        <h2 class="section-title">연락하기</h2>
        <div class="contact-form">
            <form id="contact-form" action="https://formspree.io/f/xpwdgdnq" method="POST">
                <div class="form-group">
                    <input type="text" name="name" class="form-control" placeholder="이름" required>
                </div>
                <div class="form-group">
                    <input type="email" name="email" class="form-control" placeholder="이메일" required>
                </div>
                <div class="form-group">
                    <input type="text" name="contact" class="form-control" placeholder="연락처 (전화번호 또는 카카오톡 ID)">
                </div> 
                <div class="form-group">
                    <textarea name="message" class="form-control" placeholder="메시지" required></textarea>
                </div>
                <button type="submit" class="btn" id="submit-btn">메시지 보내기</button>
            </form>
        </div>
    </div>
</section>


<!-- 뉴스레터 섹션 -->
<!-- 뉴스레터 구독 섹션 -->
 {{/* 뉴스레터 섹션 - 임시 비활성화
<section class="newsletter-section">
    <div class="container">
        <div class="newsletter-content">
            <!-- 헤더 -->
            <div class="newsletter-header">
                <h2 class="newsletter-title">
                    <!-- <i class="fas fa-envelope"></i> -->
                    <span>NFP</span>뉴스레터
                </h2>
                <p class="newsletter-description">
                    새로운 포트폴리오와 프로젝트 소식을 가장 먼저 받아보세요
                </p>
            </div>
            
            <!-- Netlify Forms 구독 폼 -->
            <form name="newsletter-signup" method="POST" data-netlify="true" class="newsletter-form" id="newsletter-form">
                <input type="hidden" name="form-name" value="newsletter-signup">
                
                <!-- 이메일 입력 -->
                <div class="form-group">
                    <div class="input-wrapper">
                        <input 
                            type="email" 
                            name="email" 
                            placeholder="이메일 주소를 입력하세요" 
                            required 
                            class="newsletter-input"
                            id="newsletter-email"
                        >
                        <button type="submit" class="newsletter-submit">
                            <span class="submit-text">구독하기</span>
                            <i class="fas fa-paper-plane submit-icon"></i>
                        </button>
                    </div>
                </div>
                
                <!-- 관심 분야 선택 (선택사항) -->
                <div class="interest-group">
                    <p class="interest-label">관심 있는 분야를 선택해주세요 (선택사항):</p>
                    <div class="interest-checkboxes">
                        <label class="interest-item">
                            <input type="checkbox" name="interests" value="웹디자인">
                            <span class="checkmark"></span>
                            웹디자인
                        </label>
                        <label class="interest-item">
                            <input type="checkbox" name="interests" value="컨텐츠디자인">
                            <span class="checkmark"></span>
                            컨텐츠디자인
                        </label>
                        <label class="interest-item">
                            <input type="checkbox" name="interests" value="크리에이티브디자인">
                            <span class="checkmark"></span>
                            크리에이티브디자인
                        </label>
                        <label class="interest-item">
                            <input type="checkbox" name="interests" value="영상디자인">
                            <span class="checkmark"></span>
                            영상디자인
                        </label>
                        <label class="interest-item">
                            <input type="checkbox" name="interests" value="프로그래밍">
                            <span class="checkmark"></span>
                            프로그래밍
                        </label>
                        <label class="interest-item">
                            <input type="checkbox" name="interests" value="광고디자인">
                            <span class="checkmark"></span>
                            광고디자인
                        </label>
                    </div>
                </div>
                
                <!-- 개인정보 동의 -->
                <div class="newsletter-privacy">
                    <label class="privacy-checkbox">
                        <input type="checkbox" name="privacy_agree" required>
                        <span class="checkmark"></span>
                        <span class="privacy-text">
                            개인정보 수집 및 이용에 동의합니다. 
                            <a href="/privacy" target="_blank">개인정보처리방침 보기</a>
                        </span>
                    </label>
                </div>
                
                <!-- 성공/오류 메시지 -->
                <div class="form-message" id="form-message" style="display: none;">
                    <div class="message-content"></div>
                </div>
            </form>
            
            <!-- 구독 혜택 -->
            <div class="newsletter-benefits">
                <h3 class="benefits-title">구독하시면 이런 것들을 받아보실 수 있어요</h3>
                <ul class="benefits-list">
                    <li><i class="fas fa-palette"></i> 새로운 포트폴리오 및 프로젝트 업데이트</li>
                    <li><i class="fas fa-lightbulb"></i> NFP 디자인의 신규 소식</li>
                    <li><i class="fas fa-star"></i> 비하인드 스토리 및 작업 과정</li>
                    <!-- <li><i class="fas fa-gift"></i> 무료 디자인 템플릿 및 리소스</li> -->
                    <li><i class="fas fa-calendar-alt"></i> 언제든 구독 취소 가능</li>
                </ul>
            </div>
        </div>
    </div>
</section>
*/}}

<!-- 뉴스레터 폼 JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('newsletter-form');
    const message = document.getElementById('form-message');
    
    if (form) {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(form);
            const email = formData.get('email');
            const privacyAgree = formData.get('privacy_agree');
            
            // 유효성 검사
            if (!email || !privacyAgree) {
                showMessage('이메일을 입력하고 개인정보 처리방침에 동의해주세요.', 'error');
                return;
            }
            
            // 제출 버튼 비활성화
            const submitBtn = form.querySelector('.newsletter-submit');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 구독 중...';
            submitBtn.disabled = true;
            
            // 관심 분야 수집
            const interests = [];
            const checkedInterests = form.querySelectorAll('input[name="interests"]:checked');
            checkedInterests.forEach(input => interests.push(input.value));
            
            // Netlify Forms로 제출
            const submitData = new URLSearchParams();
            submitData.append('form-name', 'newsletter-signup');
            submitData.append('email', email);
            submitData.append('interests', interests.join(', '));
            submitData.append('privacy_agree', privacyAgree);
            
            fetch('/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: submitData
            })
            .then(response => {
                if (response.ok) {
                    showMessage('🎉 구독이 완료되었습니다! 곧 환영 이메일을 받아보실 수 있어요.', 'success');
                    form.reset();
                    
                    // Google Analytics 이벤트 추적
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'newsletter_signup', {
                            event_category: 'lead_generation',
                            event_label: 'newsletter',
                            interests: interests.join(', ')
                        });
                    }
                } else {
                    throw new Error('Network response was not ok');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showMessage('구독 처리 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.', 'error');
            })
            .finally(() => {
                // 제출 버튼 복원
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        });
    }
    
    function showMessage(text, type) {
        if (!message) return;
        
        message.style.display = 'block';
        message.className = `form-message ${type}`;
        message.querySelector('.message-content').textContent = text;
        
        // 스크롤을 메시지로 이동
        message.scrollIntoView({ behavior: 'smooth', block: 'center' });
        
        // 5초 후 메시지 숨기기
        setTimeout(() => {
            message.style.display = 'none';
        }, 6000);
    }
});
</script>



<!-- 팝업 배너 슬라이더 (PC 전용) -->
<div id="popup-banner" class="popup-banner">
    <div class="popup-banner-container">
        <!-- 배너 이미지 영역 -->
        <div class="popup-banner-slider">
            <div class="popup-banner-slide active">
                <img src="img/popup-banner-1.jpg" alt="팝업 배너 1">
            </div>
            <div class="popup-banner-slide">
                <img src="img/popup-banner-2.jpg" alt="팝업 배너 2">
            </div>
            <div class="popup-banner-slide">
                <img src="img/popup-banner-3.jpg" alt="팝업 배너 3">
            </div>
            <div class="popup-banner-slide">
                <img src="img/popup-banner-4.jpg" alt="팝업 배너 4">
            </div>
            <div class="popup-banner-slide">
                <img src="img/popup-banner-5.jpg" alt="팝업 배너 5">
            </div>
        </div>
        
        <!-- 네비게이션 도트 -->
        <div class="popup-banner-dots">
            <span class="popup-dot active" data-slide="0"></span>
            <span class="popup-dot" data-slide="1"></span>
            <span class="popup-dot" data-slide="2"></span>
            <span class="popup-dot" data-slide="3"></span>
            <span class="popup-dot" data-slide="4"></span>
        </div>
        
        <!-- 하단 버튼 영역 -->
        <div class="popup-banner-controls">
            <button class="popup-hide-today">오늘 하루 보지않음</button>
            <button class="popup-close">닫기</button>
        </div>
    </div>
</div>

<!-- 소식 섹션 상세 모달 -->
<div id="portfolio-modal" class="portfolio-modal">
    <div class="portfolio-modal-overlay"></div>
    <div class="portfolio-modal-content">
        <div class="modal-header">
            <h2>NFP 디자인 <span>소개</span></h2>
            <button class="modal-close" id="modal-close-btn">&times;</button>
        </div>
        
        <div class="modal-body">
            <!-- 웹 디자인 -->
            <div class="portfolio-category">
                <div class="category-header">
                    <!-- <div class="category-icon">🌐</div> -->
                     <div class="category-icon"><i class="fas fa-globe"></i></div>
                    <h3>웹 디자인</h3>
                </div>
                <div class="category-content">
                    <p class="category-description">사용자 경험을 중시한 현대적이고 반응형 웹 디자인</p>
                    <div class="category-skills">
                        <span class="skill-tag primary">홈페이지 디자인</span>
                        <span class="skill-tag">디지털 배너 디자인</span>
                        <span class="skill-tag">상세페이지 디자인</span>
                        <span class="skill-tag">UI/UX 디자인</span>
                    </div>
                    <div class="category-tools">
                        <strong>사용 툴:</strong> Adobe XD, Photoshop, Illustrator
                    </div>
                </div>
            </div>

            <!-- 컨텐츠 디자인 -->
            <div class="portfolio-category">
                <div class="category-header">
                    <!-- <div class="category-icon">📱</div> -->
                     <div class="category-icon"><i class="fas fa-file-alt"></i></div>
                    <h3>컨텐츠 디자인</h3>
                </div>
                <div class="category-content">
                    <p class="category-description">SNS와 온라인 마케팅을 위한 다양한 디지털 컨텐츠</p>
                    <div class="category-skills">
                        <span class="skill-tag primary">카드뉴스 디자인</span>
                        <span class="skill-tag">포스터 디자인</span>
                        <span class="skill-tag">SNS 광고 디자인</span>
                    </div>
                    <div class="category-tools">
                        <strong>사용 툴:</strong> Photoshop, Illustrator
                    </div>
                </div>
            </div>

            <!-- 크리에이티브 디자인 -->
            <div class="portfolio-category">
                <div class="category-header">
                    <!-- <div class="category-icon">🎨</div> -->
                    <div class="category-icon"><i class="fas fa-palette"></i></div>
                    <h3>크리에이티브 디자인</h3>
                </div>
                <div class="category-content">
                    <p class="category-description">독창적이고 임팩트 있는 창작 디자인</p>
                    <div class="category-skills">
                        <span class="skill-tag primary">로고 디자인</span>
                        <span class="skill-tag">브랜딩</span>
                        <span class="skill-tag">게임 광고 디자인</span>
                        <span class="skill-tag">인터넷 방송 디자인</span>
                    </div>
                    <div class="category-tools">
                        <strong>사용 툴:</strong> Illustrator, Photoshop, After Effects
                    </div>
                </div>
            </div>

            <!-- 영상 디자인 -->
            <div class="portfolio-category">
                <div class="category-header">
                    <!-- <div class="category-icon">🎬</div> -->
                    <div class="category-icon"><i class="fas fa-play"></i></div>
                    <h3>영상 디자인</h3>
                </div>
                <div class="category-content">
                    <p class="category-description">동적이고 매력적인 영상 컨텐츠 제작</p>
                    <div class="category-skills">
                        <span class="skill-tag primary">영상 제작</span>
                        <span class="skill-tag">영상 편집</span>
                        <span class="skill-tag">모션 그래픽</span>
                        <span class="skill-tag">유튜브 썸네일 디자인</span>
                    </div>
                    <div class="category-tools">
                        <strong>사용 툴:</strong> After Effects, Premiere Pro, Cinema 4D, Illustrator, Photoshop
                    </div>
                </div>
            </div>

            <!-- 프로그래밍 -->
            <div class="portfolio-category">
                <div class="category-header">
                    <!-- <div class="category-icon">💻</div> -->
                    <div class="category-icon"><i class="fas fa-code"></i></div>
                    <h3>프로그래밍</h3>
                </div>
                <div class="category-content">
                    <p class="category-description">디자인과 기술을 결합한 프로그래밍</p>
                    <div class="category-skills">
                        <span class="skill-tag primary">프론트엔드</span>
                        <span class="skill-tag">웹 퍼블리싱</span>
                        <span class="skill-tag">모바일 앱</span>
                        <span class="skill-tag">게임 개발</span>
                    </div>
                    <div class="category-tools">
                        <strong>사용 기술:</strong> HTML5, CSS3, JavaScript, Hugo, Unity
                    </div>
                </div>
            </div>

            <!-- 광고/인쇄 디자인 -->
            <div class="portfolio-category">
                <div class="category-header">
                    <!-- <div class="category-icon">🖨️</div> -->
                     <div class="category-icon"><i class="fas fa-print"></i></div>
                    <h3>광고/인쇄 디자인</h3>
                </div>
                <div class="category-content">
                    <p class="category-description">오프라인 매체를 위한 전문적인 인쇄물 디자인</p>
                    <div class="category-skills">
                        <span class="skill-tag primary">현수막/엑스배너 디자인</span>
                        <span class="skill-tag">명함 디자인</span>
                        <span class="skill-tag">브로슈어/카탈로그 디자인</span>
                        <span class="skill-tag">광고 매체 디자인</span>
                        <span class="skill-tag">패키지 디자인</span>
                    </div>
                    <div class="category-tools">
                        <strong>사용 툴:</strong> InDesign, Illustrator, Photoshop
                    </div>
                </div>
            </div>

            
        </div>
        
        <div class="modal-footer">
            <div class="modal-contact-info">
                <p>10년 이상의 경력을 바탕으로 다양한 분야의 디자인을 제공합니다.</p>
                <a href="#contact" class="btn modal-contact-btn" id="modal-contact-btn">프로젝트 문의하기</a>
            </div>
        </div>
    </div>
</div>

<!-- 성공 팝업 (테마 컬러 적용) -->
<div id="success-popup" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 9999; align-items: center; justify-content: center;">
    <div style="
        background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%); 
        border: 2px solid #01FF75; 
        padding: 50px 40px; 
        border-radius: 15px; 
        text-align: center; 
        max-width: 450px; 
        margin: 20px;
        box-shadow: 0 20px 40px rgba(1, 255, 117, 0.3);
        backdrop-filter: blur(10px);
    ">
        <div style="
            font-size: 48px; 
            margin-bottom: 20px;
            color: #01FF75;
            animation: checkmark 0.6s ease-in-out;
        ">✅</div>
        <h3 style="
            color: #01FF75; 
            margin-bottom: 15px; 
            font-size: 24px;
            font-weight: 700;
        ">메시지 전송 완료!</h3>
        <p style="
            color: #ffffff; 
            margin-bottom: 35px; 
            line-height: 1.6;
            font-size: 16px;
            opacity: 0.9;
        ">메시지가 성공적으로 전송되었습니다.<br>빠른 시일 내에 답변드리겠습니다.</p>
        <button onclick="closePopup()" style="
            background: linear-gradient(135deg, #01FF75 0%, #00cc5a 100%); 
            color: #000000; 
            border: none; 
            padding: 15px 35px; 
            border-radius: 8px; 
            cursor: pointer;
            font-size: 16px;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(1, 255, 117, 0.4);
        " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 12px 25px rgba(1, 255, 117, 0.6)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 8px 20px rgba(1, 255, 117, 0.4)';">확인</button>
    </div>
</div>

<!-- /* 팝업 나타나는 애니메이션 */ -->
<style>
@keyframes checkmark {
    0% {
        transform: scale(0);
        opacity: 0;
    }
    50% {
        transform: scale(1.2);
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}


#success-popup {
    animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        backdrop-filter: blur(0px);
    }
    to {
        opacity: 1;
        backdrop-filter: blur(10px);
    }
}

/* 버튼 컨테이너 */
.about-buttons {
    display: flex;
    gap: 0px;
    flex-wrap: wrap;
    margin-top: 20px;
}

/* 포트폴리오 모달 스타일 */
.portfolio-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10000;
    overflow-y: auto;
}

.modal-header span{
    color: white;
}

.portfolio-modal.show {
    display: block;
    animation: modalFadeIn 0.3s ease-out;
}

.portfolio-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(5px);
}

.portfolio-modal-content {
    position: relative;
    max-width: 900px;
    margin: 50px auto;
    background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
    border-radius: 20px;
    border: 2px solid #01FF75;
    box-shadow: 0 25px 50px rgba(1, 255, 117, 0.2);
    animation: modalSlideIn 0.4s ease-out;
}

/* 모달 헤더 */
.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 30px 40px 20px;
    border-bottom: 1px solid rgba(1, 255, 117, 0.2);
}

.modal-header h2 {
    color: #01FF75;
    font-size: 28px;
    font-weight: 700;
    margin: 0;
}

.modal-close {
    background: none;
    border: none;
    color: #01FF75;
    font-size: 30px;
    cursor: pointer;
    padding: 0;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    line-height: 1;

    font-family: Arial, sans-serif; /* 더 균형잡힌 폰트 */
    line-height: 0; /* 0으로 변경 */
    font-weight: normal;
}

.modal-close:hover {
    background: rgba(1, 255, 117, 0.1);
    transform: rotate(90deg);
}

/* 모달 바디 */
.modal-body {
    padding: 30px 40px;
    max-height: 60vh;
    overflow-y: auto;
}

.portfolio-category {
    margin-bottom: 40px;
    padding: 25px;
    background: rgba(1, 255, 117, 0.05);
    border-radius: 15px;
    border: 1px solid rgba(1, 255, 117, 0.1);
}

.category-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

.category-icon {
    font-size: 24px;
    margin-right: 15px;
    width: 40px;
    height: 40px;
    background: rgba(1, 255, 117, 0.1);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.category-header h3 {
    color: #01FF75;
    font-size: 22px;
    font-weight: 600;
    margin: 0;
}

.category-description {
    color: #ffffff;
    font-size: 16px;
    margin-bottom: 20px;
    opacity: 0.9;
    line-height: 1.6;
}

.category-skills {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
}

.skill-tag {
    background: rgba(255, 255, 255, 0.1);
    color: #ffffff;
    padding: 8px 15px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 500;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
}

.skill-tag.primary {
    background: rgba(1, 255, 117, 0.2);
    color: #01FF75;
    border-color: rgba(1, 255, 117, 0.4);
    font-weight: 600;
}

.skill-tag:hover {
    background: rgba(1, 255, 117, 0.2);
    color: #01FF75;
    border-color: #01FF75;
    transform: translateY(-2px);
}

.category-tools {
    color: #ffffff;
    font-size: 14px;
    opacity: 0.8;
}

.category-tools strong {
    color: #01FF75;
}

/* 모달 푸터 */
.modal-footer {
    padding: 20px 40px 30px;
    border-top: 1px solid rgba(1, 255, 117, 0.2);
    text-align: center;
}

.modal-contact-info p {
    color: #ffffff;
    font-size: 16px;
    margin-bottom: 20px;
    opacity: 0.9;
}

.modal-contact-btn {
    /* background: linear-gradient(135deg, #01FF75 0%, #00cc5a 100%); */
    color: #000000;
    padding: 15px 30px;
    border-radius: 10px;
    font-weight: 600;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
}

.modal-contact-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(1, 255, 117, 0.4);
}

/* 모달 우측 스크롤 스타일 */
.modal-body::-webkit-scrollbar {
    width: 20px !important;
}

.modal-body::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
}

.modal-body::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, #01FF75 0%, #00cc5a 100%);
    border-radius: 10px;
    border: 1px solid rgba(1, 255, 117, 0.3);
}

.modal-body::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(180deg, #00cc5a 0%, #01FF75 100%);
    box-shadow: 0 0 10px rgba(1, 255, 117, 0.5);
}

/* Firefox 지원 */
.modal-body {
    scrollbar-width: thin;
    scrollbar-color: #01FF75 rgba(255, 255, 255, 0.1);
    overflow-y: scroll !important; /* 여기가 맞는 위치! */
    
    overflow-y: scroll !important;
    overflow-x: hidden !important;
    /* 항상 스크롤바 표시 */
    scrollbar-width: auto !important; /* Firefox */
    
}



/* 애니메이션 */
@keyframes modalFadeIn {
    from { 
        opacity: 0;
        backdrop-filter: blur(0px);
    }
    to { 
        opacity: 1;
        backdrop-filter: blur(5px);
    }
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-50px) scale(0.8);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes modalFadeOut {
    from { 
        opacity: 1;
        backdrop-filter: blur(5px);
    }
    to { 
        opacity: 0;
        backdrop-filter: blur(0px);
    }
}

@keyframes modalSlideOut {
    from {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
    to {
        opacity: 0;
        transform: translateY(-50px) scale(0.8);
    }
}

.portfolio-modal.closing {
    animation: modalFadeOut 0.3s ease-in;
}

.portfolio-modal.closing .portfolio-modal-content {
    animation: modalSlideOut 0.3s ease-in;
}

/* 반응형 */
@media (max-width: 768px) {
    .portfolio-modal-content {
        margin: 20px;
        max-width: 400px;
    }

    
    .modal-header {
        padding: 20px 25px 15px;
    }
    
    .modal-header h2 {
        font-size: 22px;
    }
    
    .modal-body {
        padding: 20px 25px;
        max-height: 70vh;
    }
    
    .portfolio-category {
        padding: 20px;
        margin-bottom: 25px;
    }
    
    .category-header h3 {
        font-size: 18px;
    }
    
    .modal-footer {
        padding: 15px 25px 20px;
    }
    
}
</style>

<!-- 연락하기 제출 폼 -->
<script>
document.getElementById('contact-form').addEventListener('submit', async function(e) {
    e.preventDefault(); // 기본 폼 제출 방지
    
    const form = e.target;
    const submitBtn = document.getElementById('submit-btn');
    const formData = new FormData(form);
    
    // 버튼 비활성화
    submitBtn.textContent = '전송 중...';
    submitBtn.disabled = true;
    
    try {
        const response = await fetch(form.action, {
            method: 'POST',
            body: formData,
            headers: {
                'Accept': 'application/json'
            }
        });
        
        if (response.ok) {
            // 성공 팝업 표시
            document.getElementById('success-popup').style.display = 'flex';
            
            // 폼 초기화
            form.reset();
        } else {
            alert('메시지 전송에 실패했습니다. 다시 시도해주세요.');
        }
    } catch (error) {
        alert('네트워크 오류가 발생했습니다. 다시 시도해주세요.');
    }
    
    // 버튼 복원
    submitBtn.textContent = '메시지 보내기';
    submitBtn.disabled = false;
});

function closePopup() {
    document.getElementById('success-popup').style.display = 'none';
}

// 팝업 배경 클릭시 닫기
document.getElementById('success-popup').addEventListener('click', function(e) {
    if (e.target === this) {
        closePopup();
    }
});

// 포트폴리오 모달 기능
document.addEventListener('DOMContentLoaded', function() {
    const portfolioBtn = document.getElementById('portfolio-detail-btn');
    const modal = document.getElementById('portfolio-modal');
    const closeBtn = document.getElementById('modal-close-btn');
    const contactBtn = document.getElementById('modal-contact-btn');
    const overlay = document.querySelector('.portfolio-modal-overlay');
    
    // 모달 열기
    portfolioBtn.addEventListener('click', function() {
        modal.classList.add('show');
        document.body.style.overflow = 'hidden'; // 스크롤 방지
    });
    
    // 모달 닫기 함수
    function closeModal() {
        // 닫기 애니메이션 클래스 추가
        modal.classList.add('closing');
        
        // 애니메이션 완료 후 모달 숨기기
        setTimeout(() => {
            modal.classList.remove('show', 'closing');
            document.body.style.overflow = 'auto'; // 스크롤 복원
        }, 300); // 애니메이션 시간과 맞춤
    }
    
    // 닫기 버튼 클릭
    closeBtn.addEventListener('click', closeModal);
    
    // 오버레이 클릭
    overlay.addEventListener('click', closeModal);
    
    // 연락하기 버튼 클릭 (모달 닫고 연락처로 이동)
    contactBtn.addEventListener('click', function() {
        closeModal();
        // 잠시 후 스크롤 (모달 닫기 애니메이션 후)
        setTimeout(() => {
            document.getElementById('contact').scrollIntoView({
                behavior: 'smooth'
            });
        }, 300);
    });
    
    // ESC 키로 모달 닫기
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modal.classList.contains('show')) {
            closeModal();
        }
    });
});
</script>

<!-- 하이라이트 섹션 스크립트 (수정됨) -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    
    // 프로젝트 카테고리와 웹데모 게시글을 제외한 데이터
    const highlightPosts = [
        {{ range (where site.RegularPages "Section" "posts") }}
        {{ if and (ne (index .Params.categories 0) "project") (not .Params.demoCode) }}
        {
            title: {{ .Title | jsonify }},
            url: {{ .RelPermalink | jsonify }},
            category: {{ if .Params.categories }}{{ index .Params.categories 0 | jsonify }}{{ else }}""{{ end }},
            subCategory: {{ .Params.subCategory | default "" | jsonify }},
            // ✨ 본문에서 YouTube/Vimeo URL 추출 (Shorts 포함)
            contentVideoUrl: {{ $youtubeMatches := findRE "youtube\\.com/watch\\?v=([a-zA-Z0-9_-]+)|youtu\\.be/([a-zA-Z0-9_-]+)|youtube\\.com/shorts/([a-zA-Z0-9_-]+)" .Content 1 }}{{ if $youtubeMatches }}{{ index $youtubeMatches 0 | jsonify }}{{ else }}{{ $vimeoMatches := findRE "vimeo\\.com/([0-9]+)" .Content 1 }}{{ if $vimeoMatches }}{{ index $vimeoMatches 0 | jsonify }}{{ else }}""{{ end }}{{ end }},
            firstImage: {{ $imageSrc := findRE "<img[^>]+src=\"([^\"]+)\"" .Content 1 }}{{ if $imageSrc }}{{ replaceRE "<img[^>]+src=\"([^\"]+)\".*" "$1" (index $imageSrc 0) | jsonify }}{{ else }}""{{ end }}
        },
        {{ end }}
        {{ end }}
    ];
    
    // URL 정리 함수
    function cleanUrl(url) {
        return typeof url === 'string' ? url.replace(/^["']|["']$/g, '') : url;
    }
    
    // 유튜브 비디오 ID 추출 (Shorts 지원)
    function extractYouTubeId(url) {
        // YouTube Shorts 패턴 추가
        const shortsRegex = /youtube\.com\/shorts\/([a-zA-Z0-9_-]+)/;
        const shortsMatch = url.match(shortsRegex);
        if (shortsMatch) return shortsMatch[1];
        
        // 기존 패턴
        const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
        const match = url.match(regex);
        return match ? match[1] : null;
    }
    
    // Vimeo ID 추출
    function extractVimeoId(url) {
        const regex = /vimeo\.com\/([0-9]+)/;
        const match = url.match(regex);
        return match ? match[1] : null;
    }
    
    // 우선순위 기반 이미지/썸네일 처리 (수정됨)
    function getImageHtml(highlight) {
        const cleanCategory = cleanUrl(highlight.category);
        const cleanSubCategory = cleanUrl(highlight.subCategory);
        const cleanContentVideoUrl = cleanUrl(highlight.contentVideoUrl); // ✨ 새로 추가
        const cleanTitle = cleanUrl(highlight.title);
        
        // ✨ 1순위: 본문에서 추출한 동영상 URL (YouTube Shorts 포함)
        if (cleanContentVideoUrl && cleanContentVideoUrl.trim()) {
            if (cleanContentVideoUrl.includes('youtube.com') || cleanContentVideoUrl.includes('youtu.be')) {
                const videoId = extractYouTubeId(cleanContentVideoUrl);
                if (videoId) {
                    return '<div class="highlight-video-container">' +
                           '<img src="https://img.youtube.com/vi/' + videoId + '/maxresdefault.jpg" alt="' + cleanTitle + '" class="highlight-square-img" onerror="this.src=\'https://img.youtube.com/vi/' + videoId + '/hqdefault.jpg\'">' +
                           '<div class="video-overlay"><i class="fas fa-play"></i></div>' +
                           '</div>';
                }
            } else if (cleanContentVideoUrl.includes('vimeo.com')) {
                const vimeoId = extractVimeoId(cleanContentVideoUrl);
                if (vimeoId) {
                    return '<div class="highlight-video-container">' +
                           '<img src="https://vumbnail.com/' + vimeoId + '.jpg" alt="' + cleanTitle + '" class="highlight-square-img" onerror="this.src=\'/img/vimeo-default.jpg\'">' +
                           '<div class="video-overlay"><i class="fas fa-play"></i></div>' +
                           '</div>';
                }
            }
        }
        
        // 2순위: 본문에서 첫 번째 이미지 추출
        if (highlight.firstImage && highlight.firstImage.trim()) {
            return '<img src="' + cleanUrl(highlight.firstImage) + '" alt="' + cleanTitle + '" class="highlight-square-img">';
        }
        
        // 3순위: 프로그래밍 카테고리 플레이스홀더
        if (cleanCategory === 'programming') {
            let icon = 'fas fa-code';
            let label = cleanSubCategory || '프로그래밍';
            
            if (cleanSubCategory === '프론트엔드') icon = 'fab fa-react';
            else if (cleanSubCategory === '백엔드') icon = 'fas fa-server';
            else if (cleanSubCategory === '웹 퍼블리싱') icon = 'fab fa-html5';
            else if (cleanSubCategory === '모바일 앱') icon = 'fas fa-mobile-alt';
            else if (cleanSubCategory === '게임 개발') icon = 'fas fa-gamepad';
            
            return '<div class="demo-placeholder-all" data-subcategory="' + cleanSubCategory + '">' +
                   '<div class="demo-icon"><i class="' + icon + '"></i></div>' +
                   '<div class="demo-label">' +
                   '<span class="demo-type">' + label + '</span>' +
                   '</div></div>';
        }
        
        // 4순위: 기본 이미지
        return '<img src="img/design1.jpg" alt="' + cleanTitle + '" class="highlight-square-img">';
    }
    
    // 랜덤 선택 함수
    function getRandomHighlights(posts, count = 5) {
        const shuffled = [...posts].sort(() => 0.5 - Math.random());
        return shuffled.slice(0, count);
    }
    
    // 더미 데이터
    const dummyHighlights = [
        { title: "브랜딩 프로젝트", url: "#", category: "creative", subCategory: "브랜딩", image: "img/design1.jpg" },
        { title: "웹사이트 리뉴얼", url: "#", category: "web", subCategory: "웹 디자인", image: "img/design1.jpg" },
        { title: "모바일 앱 디자인", url: "#", category: "content", subCategory: "앱 디자인", image: "img/design1.jpg" },
        { title: "패키지 디자인", url: "#", category: "ad", subCategory: "패키지", image: "img/design1.jpg" },
        { title: "영상 콘텐츠", url: "#", category: "video", subCategory: "영상 제작", image: "img/design1.jpg" }
    ];
    
    // 하이라이트 렌더링 함수
    function renderHighlights() {
        const container = document.getElementById('highlight-container');
        if (!container) return;
        
        const cleanedPosts = highlightPosts.map(post => ({
            ...post,
            title: cleanUrl(post.title),
            url: cleanUrl(post.url)
        }));
        
        const highlightsToShow = cleanedPosts.length > 0 ? 
            getRandomHighlights(cleanedPosts, 5) : 
            dummyHighlights;
        
        container.innerHTML = highlightsToShow.map(highlight => {
            const cleanTitle = cleanUrl(highlight.title || '');
            const finalUrl = cleanUrl(highlight.url || '');
            const cleanSubCategory = cleanUrl(highlight.subCategory || '');
            
            // 우선순위 기반 이미지 처리
            const imageHtml = getImageHtml(highlight);
            
            // subCategory가 있을 때만 오버레이 표시
            const categoryOverlay = cleanSubCategory ? 
                '<div class="category-overlay">' + cleanSubCategory + '</div>' : '';
            
            return '<div class="highlight-card board-all-item">' +
                   '<a href="' + finalUrl + '" style="display: block; text-decoration: none; color: inherit; position: relative;">' +
                   categoryOverlay +
                   imageHtml +
                   '<div class="highlight-footer">' +
                   '<h4 class="highlight-project-name">' + cleanTitle + '</h4>' +
                   '</div></a></div>';
        }).join('');
    }
    
    // 실행
    renderHighlights();
});
</script>

<!-- 메인 프로젝트 섹션 스크립트 (수정됨) -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    
    // 프로젝트 데이터
    const projectPosts = [
        {{ range (where site.RegularPages "Section" "posts") }}
        {{ if eq (index .Params.categories 0) "project" }}
        {
            title: {{ .Title | jsonify }},
            subtitle: {{ if .Params.subtitle }}{{ .Params.subtitle | jsonify }}{{ else }}""{{ end }},
            url: {{ .RelPermalink | jsonify }},
            tags: [{{ range .Params.tags }}{{ . | jsonify }},{{ end }}],
            customTags: [{{ range .Params.custom_tags }}{{ . | jsonify }},{{ end }}],
            content: {{ .Content | jsonify }},
            // ✨ 본문에서 YouTube/Vimeo URL 추출 (Shorts 포함)
            contentVideoUrl: {{ $youtubeMatches := findRE "youtube\\.com/watch\\?v=([a-zA-Z0-9_-]+)|youtu\\.be/([a-zA-Z0-9_-]+)|youtube\\.com/shorts/([a-zA-Z0-9_-]+)" .Content 1 }}{{ if $youtubeMatches }}{{ index $youtubeMatches 0 | jsonify }}{{ else }}{{ $vimeoMatches := findRE "vimeo\\.com/([0-9]+)" .Content 1 }}{{ if $vimeoMatches }}{{ index $vimeoMatches 0 | jsonify }}{{ else }}""{{ end }}{{ end }},
            firstImage: {{ $imageSrc := findRE "<img[^>]+src=\"([^\"]+)\"" .Content 1 }}{{ if $imageSrc }}{{ replaceRE "<img[^>]+src=\"([^\"]+)\".*" "$1" (index $imageSrc 0) | jsonify }}{{ else }}""{{ end }}
        },
        {{ end }}
        {{ end }}
    ];
    
    // URL 정리 함수
    function cleanUrl(url) {
        return typeof url === 'string' ? url.replace(/^["']|["']$/g, '') : url;
    }
    
    // 유튜브 비디오 ID 추출 (Shorts 지원)
    function extractYouTubeId(url) {
        // YouTube Shorts 패턴 추가
        const shortsRegex = /youtube\.com\/shorts\/([a-zA-Z0-9_-]+)/;
        const shortsMatch = url.match(shortsRegex);
        if (shortsMatch) return shortsMatch[1];
        
        // 기존 패턴
        const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
        const match = url.match(regex);
        return match ? match[1] : null;
    }
    
    // Vimeo ID 추출
    function extractVimeoId(url) {
        const regex = /vimeo\.com\/([0-9]+)/;
        const match = url.match(regex);
        return match ? match[1] : null;
    }
    
    // 이미지 추출 함수 (수정됨)
    function extractProjectImage(project) {
        // ✨ 1순위: 본문에서 추출한 동영상 URL (YouTube Shorts 포함)
        const cleanContentVideoUrl = cleanUrl(project.contentVideoUrl);
        if (cleanContentVideoUrl && cleanContentVideoUrl.trim()) {
            if (cleanContentVideoUrl.includes('youtube.com') || cleanContentVideoUrl.includes('youtu.be')) {
                const videoId = extractYouTubeId(cleanContentVideoUrl);
                if (videoId) {
                    return {
                        type: 'youtube',
                        url: 'https://img.youtube.com/vi/' + videoId + '/maxresdefault.jpg',
                        fallback: 'https://img.youtube.com/vi/' + videoId + '/hqdefault.jpg'
                    };
                }
            } else if (cleanContentVideoUrl.includes('vimeo.com')) {
                const vimeoId = extractVimeoId(cleanContentVideoUrl);
                if (vimeoId) {
                    return {
                        type: 'vimeo',
                        url: 'https://vumbnail.com/' + vimeoId + '.jpg',
                        fallback: '/img/vimeo-default.jpg'
                    };
                }
            }
        }
        
        // 2순위: Hugo에서 미리 추출한 이미지 사용
        if (project.firstImage && project.firstImage.trim()) {
            return {
                type: 'image',
                url: cleanUrl(project.firstImage)
            };
        }
        
        // 3순위: HTML 콘텐츠에서 img 태그 추출
        if (project.content) {
            const imgMatch = project.content.match(/<img[^>]+src="([^"]+)"/i);
            if (imgMatch) {
                return {
                    type: 'image',
                    url: imgMatch[1]
                };
            }
        }
        
        // 4순위: 기본 이미지
        return {
            type: 'image',
            url: 'img/design1.jpg'
        };
    }
    
    // 랜덤 선택
    function getRandomProjects(posts, count = 6) {
        const shuffled = [...posts].sort(() => 0.5 - Math.random());
        return shuffled.slice(0, count);
    }
    
    // 더미 데이터
    const dummyProjects = [
        { title: "E-Commerce 플랫폼", subtitle: "온라인 쇼핑몰 프로젝트", url: "#", tags: ["WEB"], image: "img/design1.jpg" },
        { title: "브랜딩 프로젝트", subtitle: "브랜드 아이덴티티 구축", url: "#", tags: ["BRAND"], image: "img/design1.jpg" },
        { title: "모바일 앱", subtitle: "앱 서비스 개발", url: "#", tags: ["APP"], image: "img/design1.jpg" },
        { title: "홍보 영상", subtitle: "영상 제작", url: "#", tags: ["VIDEO"], image: "img/design1.jpg" },
        { title: "게임 UI", subtitle: "게임 인터페이스", url: "#", tags: ["GAME"], image: "img/design1.jpg" },
        { title: "광고 캠페인", subtitle: "광고 디자인", url: "#", tags: ["AD"], image: "img/design1.jpg" }
    ];
    
    // 메인 렌더링
    function renderProjects() {
        const container = document.getElementById('main-projects-container');
        if (!container) return;
        
        // 데이터 정리
        const cleanedPosts = projectPosts.map(post => ({
            ...post,
            title: cleanUrl(post.title),
            url: cleanUrl(post.url),
            subtitle: cleanUrl(post.subtitle)
        }));
        
        const projectsToShow = cleanedPosts.length > 0 ? 
            getRandomProjects(cleanedPosts, 6) : dummyProjects;
        
        container.innerHTML = projectsToShow.map(project => {
            const imageData = extractProjectImage(project);
            
            // ✨ 영상인 경우 재생 아이콘 추가
            let imageHtml = '';
            if (imageData.type === 'youtube' || imageData.type === 'vimeo') {
                const iconClass = imageData.type === 'vimeo' ? 'fas fa-play' : 'fas fa-play';
                const onError = imageData.fallback ? `onerror="this.src='${imageData.fallback}'"` : '';
                imageHtml = `
                    <div style="position: relative;">
                        <img src="${imageData.url}" alt="${cleanUrl(project.title)}" class="main-project-wide-img" ${onError}>
                        <div class="video-overlay">
                            <i class="${iconClass}"></i>
                        </div>
                    </div>
                `;
            } else {
                imageHtml = `<img src="${imageData.url}" alt="${cleanUrl(project.title)}" class="main-project-wide-img">`;
            }
            
            const basicTags = (project.tags || []).slice(0, 2);
            const customTags = (project.customTags || []).slice(0, 1);
            const allTags = [...basicTags, ...customTags].filter(Boolean);
            
            const tagElements = allTags.map(tag => {
                const cleanTag = cleanUrl(tag).toUpperCase();
                return `<span class="project-tag">${cleanTag}</span>`;
            }).join('');
            
            const cleanTitle = cleanUrl(project.title || '');
            const cleanSubtitle = cleanUrl(project.subtitle || '');
            const finalUrl = cleanUrl(project.url || '');
            
            return `
                <div class="main-project-card">
                    <a href="${finalUrl}" class="project-link" style="display: block; text-decoration: none; color: inherit;">
                        ${imageHtml}
                        <div class="main-project-text">
                            ${tagElements}
                            <h4 class="main-project-title">${cleanTitle}</h4>
                            <p class="main-project-description">${cleanSubtitle || '프로젝트 설명이 없습니다.'}</p>
                        </div>
                    </a>
                </div>
            `;
        }).join('');
        
        // 슬라이더 초기화
        setTimeout(() => {
            if (typeof initAutoplay === 'function') {
                initAutoplay();
            }
        }, 100);
    }
    
    // 실행
    renderProjects();
});
</script>

<!-- 메인페이지 전용 JavaScript -->
 <script src="{{ "components/banner.js" | relURL }}"></script>
<script src="{{ "components/popup.js" | relURL }}"></script>

{{ end }}
