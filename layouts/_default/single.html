{{ define "main" }}
<section class="post-section">
    <div class="container">
        <div class="post-container">
            <!-- Í≤åÏãúÍ∏Ä Ìó§Îçî -->
            <div class="post-header">
                <h1 class="post-title">{{ .Title }}</h1>
                <div class="post-meta">
                    <span class="post-date">{{ .Date.Format "2006.01.02" }}</span>
                    <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ ÌëúÏãú -->
                    {{ if .Params.categories }}
                        <span class="post-category">
                            {{ $mainCategory := index .Params.categories 0 }}
                            {{ if eq $mainCategory "web" }}Ïõπ ÎîîÏûêÏù∏{{ end }}
                            {{ if eq $mainCategory "ad" }}Í¥ëÍ≥†/Ïù∏ÏáÑ ÎîîÏûêÏù∏{{ end }}
                            {{ if eq $mainCategory "content" }}Ïª®ÌÖêÏ∏† ÎîîÏûêÏù∏{{ end }}
                            {{ if eq $mainCategory "creative" }}ÌÅ¨Î¶¨ÏóêÏù¥Ìã∞Î∏å ÎîîÏûêÏù∏{{ end }}
                            {{ if eq $mainCategory "programming" }}ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç{{ end }}
                            {{ if eq $mainCategory "video" }}ÏòÅÏÉÅ ÎîîÏûêÏù∏{{ end }}
                            {{ if eq $mainCategory "project" }}ÌîÑÎ°úÏ†ùÌä∏{{ end }}
                            {{ if .Params.subCategory }}
                                > {{ .Params.subCategory }}
                            {{ end }}
                        </span>
                    {{ else if eq .Section "news" }}
                        <span class="post-category">ÏÜåÏãù</span>
                    {{ end }}
                </div>
            </div>

            <!-- CSS ÌååÏùº Î°úÎìú -->
            <link rel="stylesheet" href="/css/lightbox.css">
            <!-- ÏõπÎç∞Î™® Ï†ÑÏö© CSS Ï∂îÍ∞Ä -->
            <link rel="stylesheet" href="/css/web-demo.css">

           <!-- Í≤åÏãúÍ∏Ä ÎÇ¥Ïö© -->
            <div class="post-content">
                <!-- ÎèôÏòÅÏÉÅ ÎòêÎäî Ïù¥ÎØ∏ÏßÄ ÌëúÏãú -->
                <div class="post-media">
                    <!-- Ïõπ Îç∞Î™® ÏΩîÎìúÍ∞Ä ÏûàÎäî Í≤ΩÏö∞ (ÌîÑÎ°†Ìä∏ÏóîÎìú/ÌçºÎ∏îÎ¶¨Ïã± Ïπ¥ÌÖåÍ≥†Î¶¨) -->
                    {{ if .Params.demoCode }}
                        {{ $demoCodeContent := "" }}
                        
                        <!-- demoCodeÍ∞Ä Îßµ ÌòïÌÉúÏù∏ÏßÄ ÌôïÏù∏ÌïòÍ≥† Ï≤òÎ¶¨ -->
                        {{ if reflect.IsMap .Params.demoCode }}
                            <!-- Netlify CMS code widget: {lang: "html", code: "Ïã§Ï†úÏΩîÎìú"} ÌòïÌÉú -->
                            {{ $demoCodeContent = index .Params.demoCode "code" }}
                        {{ else }}
                            <!-- Îã®Ïàú Î¨∏ÏûêÏó¥Ïù∏ Í≤ΩÏö∞ -->
                            {{ $demoCodeContent = .Params.demoCode }}
                        {{ end }}
                        
                        <!-- Îç∞Î™® ÏΩîÎìú ÎÇ¥Ïö©Ïù¥ Ïã§Ï†úÎ°ú Ï°¥Ïû¨ÌïòÎäîÏßÄ ÌôïÏù∏ -->
                        {{ if and $demoCodeContent (ne $demoCodeContent "") }}
                            <div class="web-demo-container">
                                <div class="demo-frame">
                                    <div class="demo-browser-bar">
                                        <div class="demo-browser-buttons">
                                            <span class="browser-btn red"></span>
                                            <span class="browser-btn yellow"></span>
                                            <span class="browser-btn green"></span>
                                        </div>
                                        <div class="demo-url-bar">{{ .Title }} - Live Demo</div>
                                    </div>
                                    <!-- Base64 Ïù∏ÏΩîÎî© Î∞©Ïãù Ïú†ÏßÄ -->
                                    <iframe class="demo-iframe" 
                                            src="data:text/html;charset=utf-8;base64,{{ $demoCodeContent | base64Encode }}" 
                                            width="100%" 
                                            height="600px" 
                                            frameborder="0"
                                            sandbox="allow-scripts allow-same-origin">
                                    </iframe>
                                </div>
                            </div>
                        {{ end }}
                    {{ end }}

                    {{ if .Params.videoUrl }}
                        <!-- YouTube ÎèôÏòÅÏÉÅÏù¥ ÏûàÎäî Í≤ΩÏö∞ -->
                        {{ $videoId := "" }}
                        {{ if (findRE "youtube\\.com|youtu\\.be" .Params.videoUrl) }}
                            {{ $videoId = replaceRE ".*(?:youtube\\.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu\\.be/)([^\"&?/ ]{11}).*" "$1" .Params.videoUrl }}
                            <!-- VideoObject Ïä§ÌÇ§Îßà Ï∂îÍ∞Ä -->
                            {{ partial "video-schema.html" (dict "videoId" $videoId "videoType" "youtube" "title" .Title "date" .Date) }}           
                            <!-- YouTube ÏûÑÎ≤†Îìú ÏòÅÏÉÅ -->
                            <div class="video-container" style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; margin-bottom: 20px;">
                                <iframe 
                                    src="https://www.youtube.com/embed/{{ $videoId }}" 
                                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                                    frameborder="0" 
                                    allowfullscreen>
                                </iframe>
                            </div>
                       {{ else if (findRE "vimeo\\.com" .Params.videoUrl) }}
                            <!-- Vimeo ÏßÄÏõê -->
                            {{ $videoId := replaceRE ".*vimeo\\.com/([0-9]+).*" "$1" .Params.videoUrl }}
                            <!-- VideoObject Ïä§ÌÇ§Îßà Ï∂îÍ∞Ä -->
                            {{ partial "video-schema.html" (dict "videoId" $videoId "videoType" "vimeo" "title" .Title "date" .Date "site" $.Site) }}
                            <div class="video-container" style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; margin-bottom: 20px;">
                                <iframe 
                                    src="https://player.vimeo.com/video/{{ $videoId }}?responsive=1&autopause=0&player_id=0&app_id=58479" 
                                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                                    frameborder="0" 
                                    allow="autoplay; fullscreen; picture-in-picture"
                                    allowfullscreen>
                                </iframe>
                            </div>
                        {{ end }}
                    {{ end }}

                    {{ if .Params.images }}
                        <!-- Ïù¥ÎØ∏ÏßÄ ÌëúÏãú (Î∞∞Ïó¥/Îã®Ïùº Î™®Îëê ÏïàÏ†ÑÌïòÍ≤å Ï≤òÎ¶¨) -->
                        {{ $images := .Params.images }}
                        {{ if eq (printf "%T" $images) "string" }}
                            <!-- Îã®Ïùº Ïù¥ÎØ∏ÏßÄÏù∏ Í≤ΩÏö∞ -->
                            <div class="post-image">
                                <img src="{{ $images | relURL }}" alt="{{ .Title }}" style="max-width: 100%; margin-bottom: 20px;">
                            </div>
                        {{ else }}
                            <!-- Î∞∞Ïó¥Ïù∏ Í≤ΩÏö∞ -->
                            {{ range $images }}
                                <div class="post-image">
                                    <img src="{{ . | relURL }}" alt="{{ $.Title }}" style="height: auto; margin-bottom: 20px; max-width: 100%;">
                                </div>
                            {{ end }}
                        {{ end }}
                    {{ else if .Params.thumbnail }}
                        <!-- Í∏∞Ï°¥ Ïç∏ÎÑ§Ïùº Ïù¥ÎØ∏ÏßÄ (ÌïòÏúÑ Ìò∏ÌôòÏÑ±) -->
                        <div class="post-image">
                            <img src="{{ .Params.thumbnail | relURL }}" alt="{{ .Title }}">
                        </div>
                    {{ end }}
                </div>

               <div class="post-body">
                    {{ $content := .Content }}
                    
                    <!-- Î≥∏Î¨∏ÏóêÏÑú ÎèôÏòÅÏÉÅ ID Ï∂îÏ∂ú Î∞è Ïä§ÌÇ§Îßà ÏÉùÏÑ± -->
                    {{ $youtubeMatches := findRE "youtube\\.com/watch\\?v=([a-zA-Z0-9_-]+)|youtu\\.be/([a-zA-Z0-9_-]+)|youtube\\.com/shorts/([a-zA-Z0-9_-]+)" $content }}
                    {{ $vimeoMatches := findRE "vimeo\\.com/([0-9]+)" $content }}
                    
                    <!-- YouTube Ïä§ÌÇ§Îßà ÏÉùÏÑ± (Ï§ëÎ≥µ Ï†úÍ±∞) -->
                    {{ $processedYouTubeIds := slice }}
                    {{ range $youtubeMatches }}
                        {{ $videoId := replaceRE ".*(?:youtube\\.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu\\.be/|youtube\\.com/shorts/)([a-zA-Z0-9_-]+).*" "$1" . }}
                        {{ if and $videoId (not (in $processedYouTubeIds $videoId)) }}
                            {{ $processedYouTubeIds = $processedYouTubeIds | append $videoId }}
                            {{ partial "video-schema.html" (dict "videoId" $videoId "videoType" "youtube" "title" $.Title "date" $.Date "site" $.Site) }}
                        {{ end }}
                    {{ end }}
                    
                    <!-- Vimeo Ïä§ÌÇ§Îßà ÏÉùÏÑ± (Ï§ëÎ≥µ Ï†úÍ±∞) -->
                    {{ $processedVimeoIds := slice }}
                    {{ range $vimeoMatches }}
                        {{ $videoId := replaceRE ".*vimeo\\.com/([0-9]+).*" "$1" . }}
                        {{ if and $videoId (not (in $processedVimeoIds $videoId)) }}
                            {{ $processedVimeoIds = $processedVimeoIds | append $videoId }}
                            {{ partial "video-schema.html" (dict "videoId" $videoId "videoType" "vimeo" "title" $.Title "date" $.Date "site" $.Site) }}
                        {{ end }}
                    {{ end }}
                    
                    <!-- Í∏∞Ï°¥ URL ‚Üí iframe Î≥ÄÌôò Ï≤òÎ¶¨ -->
                    <!-- a ÌÉúÍ∑∏Î°ú Í∞êÏã∏ÏßÑ YouTube URL Ï≤òÎ¶¨ -->
                    {{ $content = $content | replaceRE "<p><a href=\"https://www\\.youtube\\.com/watch\\?v=([a-zA-Z0-9_-]+)[^\"]*\">https://www\\.youtube\\.com/watch\\?v=[^<]+</a></p>" "<div class=\"video-container\"><iframe src=\"https://www.youtube.com/embed/$1\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe></div><p class=\"video-link\"><a href=\"https://www.youtube.com/watch?v=$1\" target=\"_blank\">üîó YouTubeÏóêÏÑú Î≥¥Í∏∞</a></p>" }}
                    
                    <!-- ÏùºÎ∞ò p ÌÉúÍ∑∏Î°ú Í∞êÏã∏ÏßÑ YouTube URL Ï≤òÎ¶¨ -->
                    {{ $content = $content | replaceRE "<p>https://www\\.youtube\\.com/watch\\?v=([a-zA-Z0-9_-]+)[^<]*</p>" "<div class=\"video-container\"><iframe src=\"https://www.youtube.com/embed/$1\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe></div><p class=\"video-link\"><a href=\"https://www.youtube.com/watch?v=$1\" target=\"_blank\">üîó YouTubeÏóêÏÑú Î≥¥Í∏∞</a></p>" }}
                    
                    <!-- youtu.be ÌòïÌÉúÎèÑ Ï≤òÎ¶¨ -->
                    {{ $content = $content | replaceRE "<p><a href=\"https://youtu\\.be/([a-zA-Z0-9_-]+)[^\"]*\">https://youtu\\.be/[^<]+</a></p>" "<div class=\"video-container\"><iframe src=\"https://www.youtube.com/embed/$1\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe></div><p class=\"video-link\"><a href=\"https://youtu.be/$1\" target=\"_blank\">üîó YouTubeÏóêÏÑú Î≥¥Í∏∞</a></p>" }}
                    
                    <!-- ‚ú® YouTube Shorts URL Ï≤òÎ¶¨ (ÏÉàÎ°ú Ï∂îÍ∞Ä) -->
                    <!-- a ÌÉúÍ∑∏Î°ú Í∞êÏã∏ÏßÑ YouTube Shorts URL -->
                    {{ $content = $content | replaceRE "<p><a href=\"https://www\\.youtube\\.com/shorts/([a-zA-Z0-9_-]+)[^\"]*\">https://www\\.youtube\\.com/shorts/[^<]+</a></p>" "<div class=\"video-container\"><iframe src=\"https://www.youtube.com/embed/$1\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe></div><p class=\"video-link\"><a href=\"https://www.youtube.com/shorts/$1\" target=\"_blank\">üîó YouTube ShortsÏóêÏÑú Î≥¥Í∏∞</a></p>" }}
                    
                    <!-- ÏùºÎ∞ò p ÌÉúÍ∑∏Î°ú Í∞êÏã∏ÏßÑ YouTube Shorts URL -->
                    {{ $content = $content | replaceRE "<p>https://www\\.youtube\\.com/shorts/([a-zA-Z0-9_-]+)[^<]*</p>" "<div class=\"video-container\"><iframe src=\"https://www.youtube.com/embed/$1\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe></div><p class=\"video-link\"><a href=\"https://www.youtube.com/shorts/$1\" target=\"_blank\">üîó YouTube ShortsÏóêÏÑú Î≥¥Í∏∞</a></p>" }}
                    
                    <!-- youtube.com/shorts (www ÏóÜÎäî Î≤ÑÏ†Ñ) -->
                    {{ $content = $content | replaceRE "<p><a href=\"https://youtube\\.com/shorts/([a-zA-Z0-9_-]+)[^\"]*\">https://youtube\\.com/shorts/[^<]+</a></p>" "<div class=\"video-container\"><iframe src=\"https://www.youtube.com/embed/$1\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe></div><p class=\"video-link\"><a href=\"https://youtube.com/shorts/$1\" target=\"_blank\">üîó YouTube ShortsÏóêÏÑú Î≥¥Í∏∞</a></p>" }}
                    
                    {{ $content = $content | replaceRE "<p>https://youtube\\.com/shorts/([a-zA-Z0-9_-]+)[^<]*</p>" "<div class=\"video-container\"><iframe src=\"https://www.youtube.com/embed/$1\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe></div><p class=\"video-link\"><a href=\"https://youtube.com/shorts/$1\" target=\"_blank\">üîó YouTube ShortsÏóêÏÑú Î≥¥Í∏∞</a></p>" }}
                    
                    <!-- Vimeo URL Ï≤òÎ¶¨ (Ïù∏ÎùºÏù∏ Ïä§ÌÉÄÏùº Ï†úÍ±∞) -->
                    {{ $content = $content | replaceRE "<p><a href=\"https://vimeo\\.com/([0-9]+)[^\"]*\">https://vimeo\\.com/[^<]+</a></p>" "<div class=\"video-container\"><iframe src=\"https://player.vimeo.com/video/$1?responsive=1&autopause=0&player_id=0&app_id=58479\" frameborder=\"0\" allow=\"autoplay; fullscreen; picture-in-picture\" allowfullscreen></iframe></div><p class=\"video-link\"><a href=\"https://vimeo.com/$1\" target=\"_blank\">üîó VimeoÏóêÏÑú Î≥¥Í∏∞</a></p>" }}
                    
                    {{ $content = $content | replaceRE "<p>https://vimeo\\.com/([0-9]+)[^<]*</p>" "<div class=\"video-container\"><iframe src=\"https://player.vimeo.com/video/$1?responsive=1&autopause=0&player_id=0&app_id=58479\" frameborder=\"0\" allow=\"autoplay; fullscreen; picture-in-picture\" allowfullscreen></iframe></div><p class=\"video-link\"><a href=\"https://vimeo.com/$1\" target=\"_blank\">üîó VimeoÏóêÏÑú Î≥¥Í∏∞</a></p>" }}
                    
                    {{ $content | safeHTML }}
                </div>

                <!-- ÌÉúÍ∑∏ ÌëúÏãú (Î≥∏Î¨∏ ÏµúÌïòÎã®) - ÌÉÄÏûÖ ÏïàÏ†Ñ Ï≤òÎ¶¨ -->
                {{ if or .Params.tags .Params.custom_tags }}
                <div class="tags-container">
                    <!-- Í∏∞Î≥∏ ÌÉúÍ∑∏ Ïö∞ÏÑ† ÌëúÏãú -->
                    {{ range .Params.tags }}
                    <span class="project-scale-badge">{{ . }}</span>
                    {{ end }}
                    <!-- Ïª§Ïä§ÌÖÄ ÌÉúÍ∑∏ (Îëê ÌòïÏãù Î™®Îëê ÏßÄÏõê) -->
                    {{ range .Params.custom_tags }}
                        {{ $tagValue := . }}
                        {{ if reflect.IsMap . }}
                            {{ $tagValue = .tag }}
                        {{ end }}
                        <span class="project-scale-badge">{{ $tagValue }}</span>
                    {{ end }}
                </div>
                {{ end }}
            </div>

        <!-- ÌéòÏù¥ÏßÄ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
        <div class="post-navigation">
            {{ $posts := slice }}
            {{ $listUrl := "" }}
            
            {{ $from := .Params.from | default "" }}
            
            {{ if eq .Section "games" }}
                {{ $posts = where .Site.RegularPages "Section" "games" }}
                {{ $listUrl = "/games/" }}
            {{ else if eq .Section "freeboard" }}
                {{ $posts = where .Site.RegularPages "Section" "freeboard" }}
                {{ $listUrl = "/freeboard/" }}
            {{ else if eq .Section "news" }}
                {{ $posts = where .Site.RegularPages "Section" "news" }}
                {{ $listUrl = "/news/" }}
            {{ else if eq .Section "notice" }}
                {{ $posts = where .Site.RegularPages "Section" "notice" }}
                {{ $listUrl = "/notice/" }}
            {{ else if eq .Section "posts" }}
                {{ $currentCategory := index .Params.categories 0 }}
                {{ $posts = where .Site.RegularPages "Params.categories" "intersect" (slice $currentCategory) }}
                {{ $listUrl = "/posts/" }}
            {{ end }}
            
            {{ $posts = $posts.ByDate.Reverse }}
            {{ $currentIndex := 0 }}
            {{ range $index, $post := $posts }}
                {{ if eq $post.Permalink $.Permalink }}
                    {{ $currentIndex = $index }}
                {{ end }}
            {{ end }}
            
            <!-- Ïù¥Ï†Ñ Í≤åÏãúÍ∏Ä -->
            {{ $prevIndex := add $currentIndex 1 }}
            {{ if lt $prevIndex (len $posts) }}
                {{ $prevPost := index $posts $prevIndex }}
                <a href="{{ $prevPost.RelPermalink }}" class="nav-previous">
                    <i class="fas fa-chevron-left"></i> Ïù¥Ï†Ñ
                </a>
            {{ else }}
                <span></span>
            {{ end }}
            
            <!-- Î™©Î°ùÏúºÎ°ú -->
            <a href="{{ $listUrl | relURL }}" class="nav-list">Î™©Î°ùÏúºÎ°ú</a>

            <!-- Îã§Ïùå Í≤åÏãúÍ∏Ä -->
            {{ $nextIndex := sub $currentIndex 1 }}
            {{ if ge $nextIndex 0 }}
                {{ $nextPost := index $posts $nextIndex }}
                <a href="{{ $nextPost.RelPermalink }}" class="nav-next">
                    Îã§Ïùå <i class="fas fa-chevron-right"></i>
                </a>
            {{ else }}
                <span></span>
            {{ end }}
        </div>
        </div>
    </div>
    
    <!-- JavaScript ÌååÏùºÎì§ -->
    <script src="/js/lightbox.js"></script>
    
</section>
{{ end }}